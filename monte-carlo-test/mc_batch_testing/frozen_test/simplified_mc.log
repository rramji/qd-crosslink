LAMMPS (8 Feb 2023)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# define variables

variable       spacing index 10.0
variable       lbox index 20.0
variable       sname string simplified_mc
variable       rtemp index 300


#package omp 4

units           real
atom_style      full
boundary        p p p
#pair_style      lj/cut/coul/long  14
pair_style      lj/charmm/coul/long/opt 13 14.00000
#pair_modify     mix arithmetic tail yes
#special_bonds   lj/coul 0.0 0.0 1.0
kspace_style    ewald 0.0001
bond_style      harmonic
angle_style     harmonic
dihedral_style  harmonic
improper_style  umbrella
#kspace_style    pppm 0.0001

# initialize a simple cumbic box for the initial structure

lattice        sc ${spacing}
lattice        sc 10.0
Lattice spacing in x,y,z = 10 10 10
region         mybox block 0 ${lbox} 0 ${lbox} 0 ${lbox} units box
region         mybox block 0 20.0 0 ${lbox} 0 ${lbox} units box
region         mybox block 0 20.0 0 20.0 0 ${lbox} units box
region         mybox block 0 20.0 0 20.0 0 20.0 units box
create_box     8 mybox                bond/types 13                angle/types 5                dihedral/types 11                improper/types 1                extra/bond/per/atom 13                extra/angle/per/atom 10                extra/dihedral/per/atom 20                extra/improper/per/atom 20                extra/special/per/atom 100
Created orthogonal box = (0 0 0) to (20 20 20)
  1 by 1 by 1 MPI processor grid

molecule       69 xlig.lammps.txt
Read molecule template 69:
  1 molecules
  0 fragments
  68 atoms with max type 7
  70 bonds with max type 10
  128 angles with max type 4
  188 dihedrals with max type 11
  39 impropers with max type 1
molecule       420 oleic.lammps.txt
Read molecule template 420:
  1 molecules
  0 fragments
  54 atoms with max type 6
  53 bonds with max type 13
  100 angles with max type 5
  141 dihedrals with max type 9
  9 impropers with max type 1


pair_modify          mix geometric
#neighbor             2.0 multi
#neigh_modify         every 2 delay 4 check yes
thermo_style         multi
thermo_modify        line multi format float %14.6f flush yes



# originally used box instead of single, which takes no args and auto populates the box until full
create_atoms   0 single 10 10 10   mol 69 42 units box
Created 68 atoms
  using box units in orthogonal box = (0 0 0) to (20 20 20)
  create_atoms CPU = 0.001 seconds
create_atoms   0 single 0 0 0  mol 420 42 units box
Created 54 atoms
  using box units in orthogonal box = (0 0 0) to (20 20 20)
  create_atoms CPU = 0.000 seconds


group xligand molecule == 69
0 atoms in group xligand
#group xligand id 1:68
#group xligand include molecule

group oleic_acid molecule == 420
0 atoms in group oleic_acid
#group oleic_acid id 69:122
#group oleic_acid include molecule



# coeffs
# Masses

mass    1 1.2011E+01 # C_3
mass    2 1.4007E+01 # N_3
mass    3 1.2011E+01 # C_R
mass    4 1.5999E+01 # O_2
mass    5 3.2060E+01 # S_3
mass    6 1.0080E+00 # H_
mass    7 1.0080E+00 # H___A
mass    8 1.5999E+01 # O_R


pair_coeff           1 1 0.09510000 3.47299041 # C_3 C_3
pair_coeff           2 2 0.07740000 3.26256026 # N_3 N_3
pair_coeff           3 3 0.09510000 3.47299041 # C_R C_R
pair_coeff           4 4 0.09570000 3.03315369 # O_2 O_2
pair_coeff           5 5 0.34400001 3.59032202 # S_3 S_3
pair_coeff           6 6 0.01520000 2.84642134 # H_ H_
pair_coeff           7 7 0.01520000 2.84642134 # H___A H___A
pair_coeff           8 8 0.09570000 3.03315369 # O_R O_R


pair_modify          mix geometric
neighbor             2.0 multi
neigh_modify         every 2 delay 4 check yes
thermo_style         multi
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:896)
thermo_modify        line multi format float %14.6f flush yes

bond_coeff           1 350 1.53000 # C_3 C_3
bond_coeff           2 350 1.09000 # C_3 H_
bond_coeff           3 350 1.46200 # N_3 C_3
bond_coeff           4 350 1.39200 # N_3 C_R
bond_coeff           5 525 1.39000 # C_R C_R
bond_coeff           6 350 1.02000 # C_R H_
bond_coeff           7 700 1.25000 # O_2 C_R
bond_coeff           8 350 1.73000 # S_3 C_R
bond_coeff           9 350 1.80000 # S_3 C_3
bond_coeff           10 350 1.36000 # S_3 H___A
bond_coeff           11 525 1.35000 # O_R C_R
bond_coeff           12 350 0.98000 # O_R H___A
bond_coeff           13 350 1.46000 # C_R C_3


angle_coeff          1 50 109.47100 # X C_3 X
angle_coeff          2 50 106.70000 # X N_3 X
angle_coeff          3 50 120 # X C_R X
angle_coeff          4 50 92.10000 # X S_3 X
angle_coeff          5 50 120 # X O_R X


dihedral_coeff       1 0.08333 -1 6 # C_R C_R C_3 X
dihedral_coeff       2 0.08333 -1 6 # O_2 C_R C_3 X
dihedral_coeff       3 0.08333 -1 6 # O_R C_R C_3 X
dihedral_coeff       4 0.11111 1 3 # X C_3 C_3 X
dihedral_coeff       5 0.16667 1 3 # X C_R C_3 X
dihedral_coeff       6 3.12500 -1 2 # X C_R C_R X
dihedral_coeff       7 0.16667 1 3 # X N_3 C_3 X
dihedral_coeff       8 0.12500 -1 6 # X N_3 C_R C_R
dihedral_coeff       9 6.25000 -1 2 # X O_R C_R X
dihedral_coeff       10 0.33333 1 3 # X S_3 C_3 X
dihedral_coeff       11 0.50000 -1 2 # X S_3 C_R X

improper_coeff       1 13.33333 0 # C_R X X X

timestep             0.5

print                .
.
print                ==========================================
==========================================
print                "500 steps CG Minimization"
500 steps CG Minimization
print                ==========================================
==========================================
print                .
.

dump                 1 all custom 25 ${sname}.min.lammpstrj id type xu yu zu vx vy vz
dump                 1 all custom 25 simplified_mc.min.lammpstrj id type xu yu zu vx vy vz
thermo               10
min_style            cg
minimize             1.0e-4 1.0e-4 500 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- neighbor multi command: doi:10.1016/j.cpc.2008.03.005, doi:10.1007/s40571-020-00361-2

@Article{Intveld08,
 author =  {in 't Veld, P. J. and S. J.~Plimpton and G. S. Grest},
 title =   {Accurate and Efficient Methods for Modeling Colloidal
            Mixtures in an Explicit Solvent using Molecular Dynamics},
 journal = {Comput.\ Phys.\ Commut.},
 year =    2008,
 volume =  179,
 pages =   {320--329}
}

@article{Shire2020,
 author = {Shire, Tom and Hanley, Kevin J. and Stratford, Kevin},
 title = {{DEM} Simulations of Polydisperse Media: Efficient Contact
          Detection Applied to Investigate the Quasi-Static Limit},
 journal = {Computational Particle Mechanics},
 year = {2020}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Switching to 'neigh_modify every 1 delay 0 check yes' setting during minimization
Ewald initialization ...
WARNING: System is not charge neutral, net charge = -0.0006 (src/kspace.cpp:327)
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.091315817
  estimated absolute RMS force accuracy = 0.034067589
  estimated relative force accuracy = 0.00010259353
  KSpace vectors: actual max1d max3d = 3 1 13
                  kxmax kymax kzmax  = 1 1 1
Generated 28 of 28 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 16
  ghost atom cutoff = 16
  binsize = 8, bins = 3 3 3
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/charmm/coul/long/opt, perpetual
      attributes: half, newton on
      pair build: half/multi/newton
      stencil: half/multi/3d
      bin: multi
Per MPI rank memory allocation (min/avg/max) = 34.05 | 34.05 | 34.05 Mbytes
------------ Step              0 ----- CPU =            0 (sec) -------------
TotEng   =   47702.739403 KinEng   =       0.000000 Temp     =       0.000000 
PotEng   =   47702.739403 E_bond   =     110.088059 E_angle  =      36.601372 
E_dihed  =      19.805602 E_impro  =       3.329327 E_vdwl   =   47534.568145 
E_coul   =      14.541173 E_long   =     -16.194275 Press    = 1638353.761727
------------ Step             10 ----- CPU =  0.004494822 (sec) -------------
TotEng   =     596.328787 KinEng   =       0.000000 Temp     =       0.000000 
PotEng   =     596.328787 E_bond   =      29.092585 E_angle  =     169.458814 
E_dihed  =      21.557488 E_impro  =       0.960121 E_vdwl   =     377.158172 
E_coul   =      14.292449 E_long   =     -16.190841 Press    =   19067.998260
------------ Step             20 ----- CPU =    0.0109479 (sec) -------------
TotEng   =     249.850599 KinEng   =       0.000000 Temp     =       0.000000 
PotEng   =     249.850599 E_bond   =      35.496544 E_angle  =     124.677896 
E_dihed  =      28.321853 E_impro  =       0.443008 E_vdwl   =      63.072505 
E_coul   =      14.029424 E_long   =     -16.190631 Press    =    2722.572857
------------ Step             30 ----- CPU =   0.01807918 (sec) -------------
TotEng   =     225.972273 KinEng   =       0.000000 Temp     =       0.000000 
PotEng   =     225.972273 E_bond   =      39.618210 E_angle  =     129.254209 
E_dihed  =      30.451618 E_impro  =       0.382901 E_vdwl   =      28.391768 
E_coul   =      14.064877 E_long   =     -16.191311 Press    =     305.603343
------------ Step             40 ----- CPU =   0.02500418 (sec) -------------
TotEng   =     219.786672 KinEng   =       0.000000 Temp     =       0.000000 
PotEng   =     219.786672 E_bond   =      34.484094 E_angle  =     129.084093 
E_dihed  =      30.985085 E_impro  =       0.487246 E_vdwl   =      26.817438 
E_coul   =      14.121248 E_long   =     -16.192534 Press    =     307.202091
------------ Step             50 ----- CPU =   0.03209399 (sec) -------------
TotEng   =     215.723883 KinEng   =       0.000000 Temp     =       0.000000 
PotEng   =     215.723883 E_bond   =      33.890767 E_angle  =     124.123501 
E_dihed  =      31.058740 E_impro  =       0.646177 E_vdwl   =      28.070354 
E_coul   =      14.128338 E_long   =     -16.193995 Press    =     378.696982
------------ Step             60 ----- CPU =   0.03993388 (sec) -------------
TotEng   =     211.069248 KinEng   =       0.000000 Temp     =       0.000000 
PotEng   =     211.069248 E_bond   =      32.989417 E_angle  =     125.700686 
E_dihed  =      31.930270 E_impro  =       0.637513 E_vdwl   =      22.013072 
E_coul   =      13.993409 E_long   =     -16.195120 Press    =      -4.340969
------------ Step             70 ----- CPU =   0.04689745 (sec) -------------
TotEng   =     208.852078 KinEng   =       0.000000 Temp     =       0.000000 
PotEng   =     208.852078 E_bond   =      31.731766 E_angle  =     125.592842 
E_dihed  =      32.788984 E_impro  =       0.501010 E_vdwl   =      20.700952 
E_coul   =      13.731832 E_long   =     -16.195308 Press    =     -19.031962
------------ Step             80 ----- CPU =   0.05401836 (sec) -------------
TotEng   =     207.619682 KinEng   =       0.000000 Temp     =       0.000000 
PotEng   =     207.619682 E_bond   =      30.797855 E_angle  =     124.635052 
E_dihed  =      32.280441 E_impro  =       0.410012 E_vdwl   =      21.931183 
E_coul   =      13.760014 E_long   =     -16.194875 Press    =      17.143243
------------ Step             90 ----- CPU =   0.06095967 (sec) -------------
TotEng   =     205.989502 KinEng   =       0.000000 Temp     =       0.000000 
PotEng   =     205.989502 E_bond   =      31.262144 E_angle  =     123.459366 
E_dihed  =      31.357782 E_impro  =       0.513904 E_vdwl   =      21.977937 
E_coul   =      13.612277 E_long   =     -16.193908 Press    =    -182.860197
------------ Step             95 ----- CPU =   0.08322598 (sec) -------------
TotEng   =     205.345434 KinEng   =       0.000000 Temp     =       0.000000 
PotEng   =     205.345434 E_bond   =      31.256940 E_angle  =     124.109575 
E_dihed  =      30.968575 E_impro  =       0.522200 E_vdwl   =      21.072483 
E_coul   =      13.609042 E_long   =     -16.193379 Press    =    -268.491226
Loop time of 0.083254 on 1 procs for 95 steps with 122 atoms

97.6% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      47702.7394031284   205.345434110941   205.345434110941
  Force two-norm initial, final = 806464.22 17.295112
  Force max component initial, final = 496010.82 3.8946361
  Final line search alpha, max atom move = 3.9542969e-11 1.5400547e-10
  Iterations, force evaluations = 95 232

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.067658   | 0.067658   | 0.067658   |   0.0 | 81.27
Bond    | 0.0077548  | 0.0077548  | 0.0077548  |   0.0 |  9.31
Kspace  | 0.0031833  | 0.0031833  | 0.0031833  |   0.0 |  3.82
Neigh   | 0.0016583  | 0.0016583  | 0.0016583  |   0.0 |  1.99
Comm    | 0.0014623  | 0.0014623  | 0.0014623  |   0.0 |  1.76
Output  | 0.00066369 | 0.00066369 | 0.00066369 |   0.0 |  0.80
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0008735  |            |       |  1.05

Nlocal:            122 ave         122 max         122 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           1778 ave        1778 max        1778 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          14789 ave       14789 max       14789 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14789
Ave neighs/atom = 121.22131
Ave special neighs/atom = 10.967213
Neighbor list builds = 2
Dangerous builds = 0
min_style            sd
minimize             1.0e-4 1.0e-4 500 5000
Switching to 'neigh_modify every 1 delay 0 check yes' setting during minimization
Ewald initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.091315817
  estimated absolute RMS force accuracy = 0.034067589
  estimated relative force accuracy = 0.00010259353
  KSpace vectors: actual max1d max3d = 3 1 13
                  kxmax kymax kzmax  = 1 1 1
Generated 28 of 28 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 34.05 | 34.05 | 34.05 Mbytes
------------ Step             95 ----- CPU =            0 (sec) -------------
TotEng   =     205.345434 KinEng   =       0.000000 Temp     =       0.000000 
PotEng   =     205.345434 E_bond   =      31.256940 E_angle  =     124.109575 
E_dihed  =      30.968575 E_impro  =       0.522200 E_vdwl   =      21.072483 
E_coul   =      13.609042 E_long   =     -16.193379 Press    =    -268.491226
------------ Step            100 ----- CPU =   0.00365813 (sec) -------------
TotEng   =     205.173040 KinEng   =       0.000000 Temp     =       0.000000 
PotEng   =     205.173040 E_bond   =      31.264771 E_angle  =     123.956632 
E_dihed  =      30.955378 E_impro  =       0.531958 E_vdwl   =      21.049732 
E_coul   =      13.607982 E_long   =     -16.193413 Press    =    -244.190797
------------ Step            104 ----- CPU =  0.006946173 (sec) -------------
TotEng   =     205.076324 KinEng   =       0.000000 Temp     =       0.000000 
PotEng   =     205.076324 E_bond   =      31.237050 E_angle  =     123.939660 
E_dihed  =      30.940751 E_impro  =       0.530301 E_vdwl   =      21.027027 
E_coul   =      13.594959 E_long   =     -16.193424 Press    =    -237.321352
Loop time of 0.00695901 on 1 procs for 9 steps with 122 atoms

98.9% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
      205.345434110941   205.096470468925   205.076324343458
  Force two-norm initial, final = 17.295112 6.4188986
  Force max component initial, final = 3.8946361 1.6463643
  Final line search alpha, max atom move = 0.026816678 0.044150021
  Iterations, force evaluations = 9 18

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0054873  | 0.0054873  | 0.0054873  |   0.0 | 78.85
Bond    | 0.0006468  | 0.0006468  | 0.0006468  |   0.0 |  9.29
Kspace  | 0.00026436 | 0.00026436 | 0.00026436 |   0.0 |  3.80
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0001265  | 0.0001265  | 0.0001265  |   0.0 |  1.82
Output  | 0.00019766 | 0.00019766 | 0.00019766 |   0.0 |  2.84
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0002364  |            |       |  3.40

Nlocal:            122 ave         122 max         122 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           1772 ave        1772 max        1772 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          14833 ave       14833 max       14833 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14833
Ave neighs/atom = 121.58197
Ave special neighs/atom = 10.967213
Neighbor list builds = 0
Dangerous builds = 0
#now                 minimize the entire system
minimize             1.0e-4 1.0e-4 500 5000
Switching to 'neigh_modify every 1 delay 0 check yes' setting during minimization
Ewald initialization ...
  using 12-bit tables for long-range coulomb (src/kspace.cpp:342)
  G vector (1/distance) = 0.091315817
  estimated absolute RMS force accuracy = 0.034067589
  estimated relative force accuracy = 0.00010259353
  KSpace vectors: actual max1d max3d = 3 1 13
                  kxmax kymax kzmax  = 1 1 1
Generated 28 of 28 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 34.05 | 34.05 | 34.05 Mbytes
------------ Step            104 ----- CPU =            0 (sec) -------------
TotEng   =     205.076324 KinEng   =       0.000000 Temp     =       0.000000 
PotEng   =     205.076324 E_bond   =      31.237050 E_angle  =     123.939660 
E_dihed  =      30.940751 E_impro  =       0.530301 E_vdwl   =      21.027027 
E_coul   =      13.594959 E_long   =     -16.193424 Press    =    -237.321352
------------ Step            105 ----- CPU =  0.001273876 (sec) -------------
TotEng   =     205.056190 KinEng   =       0.000000 Temp     =       0.000000 
PotEng   =     205.056190 E_bond   =      31.246060 E_angle  =     123.917920 
E_dihed  =      30.937011 E_impro  =       0.530112 E_vdwl   =      21.023341 
E_coul   =      13.595173 E_long   =     -16.193426 Press    =    -233.838700
Loop time of 0.00128727 on 1 procs for 1 steps with 122 atoms

98.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
      205.076324343458   205.076324343458   205.056190121107
  Force two-norm initial, final = 6.4188986 10.477346
  Force max component initial, final = 1.6463643 3.789046
  Final line search alpha, max atom move = 0.060739898 0.23014627
  Iterations, force evaluations = 1 2

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.00090364 | 0.00090364 | 0.00090364 |   0.0 | 70.20
Bond    | 0.00011097 | 0.00011097 | 0.00011097 |   0.0 |  8.62
Kspace  | 4.1708e-05 | 4.1708e-05 | 4.1708e-05 |   0.0 |  3.24
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 1.8374e-05 | 1.8374e-05 | 1.8374e-05 |   0.0 |  1.43
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0002126  |            |       | 16.51

Nlocal:            122 ave         122 max         122 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           1772 ave        1772 max        1772 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          14835 ave       14835 max       14835 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14835
Ave neighs/atom = 121.59836
Ave special neighs/atom = 10.967213
Neighbor list builds = 0
Dangerous builds = 0
undump               1


thermo               10
fix                  freeze oleic_acid setforce 0.0 0.0 0.0
fix                  1 all gcmc 1 0 100 0 1234567 0 0 5 mol 69 full_energy mcmoves 0 1 1

compute rotate all property/atom quatw quati quatj quatk
ERROR: Compute property/atom quatw is not available (src/compute_property_atom.cpp:236)
Last command: compute rotate all property/atom quatw quati quatj quatk
